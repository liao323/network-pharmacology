q()
#安装clusterProfiler
If(!requireNamespace(“BiocManager”,quietly = TRUE))
Install.packages(“BiocManager”)
BiocManager::install(“clusterProfiler”)
 if (!requireNamespace("BiocManager", quietly = TRUE))
     install.packages("BiocManager")
BiocManager::install(“clusterProfiler”)
BiocManager::install("clusterProfiler")
BiocManager::install("org.Hs.eg.db")
library(org.Hs.eg.db)
library(clusterProfiler)#进行GO富集和KEGG富集
library(dplyr) #进行数据转换
library(ggplot2)#绘图
#导入数据，数据为一列基因名的文件
f <- read.table("C:\\Users\\liaoliao\\Desktop\\GO\\id.txt",header=T,sep='\t')
#取所需列进行后续分析
x <-f[,1]
#利用bitr函数进行id转换，使用bioconductor的db系列包进行
hg<-bitr(x,fromType="SYMBOL",toType=c("ENTREZID","ENSEMBL","SYMBOL"),OrgDb="org.Hs.eg.db")
#查看hg的信息，三列信息包括ENTREZID、ENSEMBL、SYMBOL
head(hg)
#进行GO富集，确定P值与Q值得卡值并使用BH方法对值进行调整。
go <- enrichGO(hg$ENTREZID,OrgDb = org.Hs.eg.db, ont='ALL',pAdjustMethod = 'BH',pvalueCutoff = 0.05, qvalueCutoff = 0.2,keyType = 'ENTREZID')
#查看富集结果
dim(go)
#导出GO富集的结果
write.csv(go,file="go.csv")
barplot(go,showCategory=20,drop=T)#柱状图
dotplot(go,showCategory=20)#气泡图
#将ont=ALL，换成CC、BP、MF分别进行富集
goCC <- enrichGO(hg$ENTREZID,OrgDb = org.Hs.eg.db, ont='CC',pAdjustMethod = 'BH',pvalueCutoff = 0.05, qvalueCutoff = 0.2,keyType = 'ENTREZID')
goBP <- enrichGO(hg$ENTREZID,OrgDb = org.Hs.eg.db, ont='BP',pAdjustMethod = 'BH',pvalueCutoff = 0.05, qvalueCutoff = 0.2,keyType = 'ENTREZID')
goMF <- enrichGO(hg$ENTREZID,OrgDb = org.Hs.eg.db, ont='MF',pAdjustMethod = 'BH',pvalueCutoff = 0.05, qvalueCutoff = 0.2,keyType = 'ENTREZID')
 #进行KEGG富集
kegg <- enrichKEGG(hg$ENTREZID, organism = 'hsa', keyType = 'kegg', pvalueCutoff = 0.05, pAdjustMethod = 'BH', minGSSize = 3, maxGSSize = 500, qvalueCutoff = 0.2, use_internal_data = FALSE)
#导出富集结果
write.csv(kegg,file = "kegg.csv")
#查看富集结果
dim(kegg)
#可视化，同上
dotplot(kegg, showCategory=20) #气泡图
#pathway映射
browseKEGG(kegg, "hsa03728") #在pathway通路图上标记富集到的基因，会链接到KEGG官网
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 35,height = 20,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 35,height = 20,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
###Video source: http://study.163.com/u/biowolf
######Video source: https://shop119322454.taobao.com
######速科生物: http://www.biowolf.cn/
######作者邮箱：2740881706@qq.com
######作者微信: seqBio
######QQ群:  259208034
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 20,height = 35,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 20,height = 35,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 25,height = 30,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 25,height = 30,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.08, qvalueCutoff = 0.08)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 25,height = 30,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 25,height = 30,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 25,height = 35,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 25,height = 35,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 25,height = 40,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 25,height = 40,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 30,height = 40,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 30,height = 40,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 30,height = 45,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 30,height = 40,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
setwd("C:\\Users\\liaoliao\\Desktop\\GO")
library("clusterProfiler")
library("org.Hs.eg.db")
rt=read.table("id.txt",sep="\t",header=T,check.names=F)
rt=rt[is.na(rt[,"entrezID"])==F,]
cor=rt$logFC
gene=rt$entrezID
names(cor)=gene
#GO富集分析
kk <- enrichGO(gene = gene,OrgDb = org.Hs.eg.db, pvalueCutoff =0.05, qvalueCutoff = 0.05)
write.table(kk,file="GO.txt",sep="\t",quote=F,row.names = F)
#柱状图
tiff(file="barplot.tiff",width = 35,height = 45,units ="cm",compression="lzw",bg="white",res=600)
barplot(kk, drop = TRUE, showCategory =20)
dev.off()
#点图
tiff(file="dotplot.tiff",width = 25,height = 40,units ="cm",compression="lzw",bg="white",res=600)
dotplot(kk,showCategory = 20)
dev.off()
q()
